logger:
  is_json: true
  add_source: false
  level: debug
  set_file: false
  file_name: logs/app.log
  max_size: 10
  max_backups: 3
  max_age: 7

jwt:
  secret_path: testdata/jwt/.secret # path to file with secret key
  secret_hash_len: 30
  access_exp_at: 60 # minutes
  refresh_exp_at: 7 # days

nats:
  notification:
    nats_url: nats://localhost:4222
    consumer:
      stream_name: NOTIFICATION
      subject: notifications.user.
      timeout: 10 # second
      stream_option:
        name: NOTIFICATION
        storage: 0 # 0 - nats.FileStorage, 1 - nats.MemoryStorage
        retention: 2 # 0 - nats.LimitsPolicy, 1 - nats.InterestPolicy, 2 - nats.WorkQueuePolicy
        max_age:  10 # minute
        max_msgs: 10000
        max_bytes: 20971520 # 20 MB
        discard: 0 # 0 - nats.DiscardOld, 1 - nats.DiscardNew
      nats_option:
        max_reconnects: 10
        reconnect_wait: 2 # second
        reconnect_jitter:
          jitter: 200 # millisecond
          jitter_for_tls: 500 # millisecond
        timeout: 3 # second
        drain_timeout: 5 # second
        ping_interval: 2 # minute
        max_pings_outstanding: 5
        name: notification_consumer_
        closed_handler: true
        reconnect_handler: true
        disconnect_err_handler: true
        error_handler: true
      subscribe_option:
        durable: notification_consumer_
        manual_ack: true
        ack_wait: 30 # second
        max_ack_pending: 100
        deliver_all: true
    publisher:
      stream_name: NOTIFICATION
      subject: notifications.user.
      timeout: 10 # second
      stream_option:
        name: NOTIFICATION
        storage: 0 # 0 - nats.FileStorage, 1 - nats.MemoryStorage
        retention: 2 # 0 - nats.LimitsPolicy, 1 - nats.InterestPolicy, 2 - nats.WorkQueuePolicy
        max_age: 10 # minute
        max_msgs: 10000
        max_bytes: 20971520 # 20 MB
        discard: 0 # 0 - nats.DiscardOld, 1 - nats.DiscardNew
        replicas: 1
        allow_direct: true
        deny_delete: true
        deny_purge: true
      nats_option:
        max_reconnects: -1
        reconnect_wait: 2 # second
        reconnect_jitter:
          jitter: 200 # millisecond
          jitter_for_tls: 500 # millisecond
        name: notification_publisher_
        error_handler: true
      jet_stream_option:
        publish_async_max_pending: 1024
        publish_async_err_handler: true

postgres:
  host: localhost
  user: admin
  password: test
  dbname: lingvogramm_db
  port: 54320
  sslmode: disable
  pool_max_conns: 10
  migrations_dir: file://migrations
  query_timeout: 2 # 2 second

big_cache:
  shards: 512
  life_window: 5 # minutes
  clean_window: 1 # minutes
  max_entries_in_window: 1_000_000
  max_entry_size: 512
  hard_max_cache_size: 600
  verbose: true
  is_on_remove_with_reason: true

redis:
  addr: 127.0.0.1:63790
  password: auth
  db: 0
  dial_timeout: 5 # second
  read_timeout: 3 # second
  write_timeout: 3 # second
  pool_size: 10
  min_idle_conns: 3
  pool_timeout: 4 # second
  max_retries: 3
  min_retry_backoff: 8 # millisecond
  max_retry_backoff: 512 # millisecond
  refresh_token:
    query_timeout: 2 # second
    expiration: 7 # days
  un_delete_file_client:
    query_timeout: 2 # second
    expiration: 0 # days
  un_delete_file_achievement:
    query_timeout: 2 # second
    expiration: 0 # days
  un_delete_file_award:
    query_timeout: 2 # second
    expiration: 0 # days

file_server:
  client_assets:
    path: /images/client*
    url: /images/client
    dir: testdata/file_server/images/client
    max_file_size: 5242880 # 5 MB
    image_quality: 30
    browse: true
    compress: true
  achievement_assets:
    path: /images/achievement*
    url: /images/achievement
    dir: testdata/file_server/images/achievement
    max_file_size: 5242880 # 5 MB
    image_quality: 30
    browse: true
    compress: true
  award_assets:
    path: /images/award*
    url: /images/award
    dir: testdata/file_server/images/award
    max_file_size: 5242880 # 5 MB
    image_quality: 30
    browse: true
    compress: true
  dir_perm: 0755
  file_perm: 0644

cron:
  un_delete_file_client_cleaner:
    sleep_duration: 1440 # minutes
    timeout: 15 # second
  un_delete_file_achievement_cleaner:
    sleep_duration: 1 # minutes
    timeout: 15 # second
  un_delete_file_award_cleaner:
    sleep_duration: 1 # minutes
    timeout: 15 # second

middleware:
  content_length_limiter:
    max_body_size: 5242880

cookie:
  refresh:
    name: refresh
    path: /
    domain: 127.0.0.1
    same_site: lax
    max_age: 2592000 # 30 days
    secure: false
    http_only: true
    partitioned: false
    session_only: false

ips:
  allowed:
    - 127.0.0.1

swagger_server:
  host: 127.0.0.1
  port: 40050
  shutdown_timeout: 10 # second
  cors:
    allow_origins:
      - "*"
    allow_methods:
      - POST
      - GET
      - PUT
      - PATCH
      - DELETE
      - HEAD
      - OPTIONS
    allow_headers:
      - Origin
      - Content-Length
      - Content-Type
      - Accept
      - Authorization
    expose_headers:
      - Content-Length
    max_age: 3600
    allow_credentials: false
    allow_private_network: false

httpserver:
  host: 127.0.0.1
  port: 50050
  shutdown_timeout: 10 # second
  disable_startup_message: false
  enable_prefork: false
  enable_print_routes: true
  cors:
    allow_origins:
      - "*"
    allow_methods:
      - POST
      - GET
      - PUT
      - PATCH
      - DELETE
      - HEAD
      - OPTIONS
    allow_headers:
      - Origin
      - Content-Length
      - Content-Type
      - Accept
      - Authorization
    expose_headers:
      - Content-Length
    max_age: 3600
    allow_credentials: false
    allow_private_network: false